---
layout: journal
title: Adding WYSIWYGs to Custom Drupal Forms with FormAPI
tags: 
- integration
- drupal 7
- drupal forms
- drupal formapi
- drupal wysiwyg
show_chat: true
show_contacts: false
---

One of the greatest assets in any Drupal developer&#39;s toolbox is the FormAPI. With the FormAPI, you can do just about anything. Form wizards, multistep forms, custom contact forms, image uploaders, there is no limit. Combining Drupal&#39;s FormAPI with CTools API grants even greated flexibility, such as object caching and advanced wizard forms. Today, we&#39;re going to start off with something simple: adding a WYSIWYG to a custom Drupal 7 form with the FormAPI. What you&#39;ll need (if you don&#39;t already have it): <ul><li><a href="http://drupal.org/project/wysiwyg" target="_blank">WYSIWYG Module</a></li><li>CKEditor, FCKEditor, or TinyMCE</li><li>Restricted input formats (Filtered HTML, etc) with access permissions assigned to roles</li></ul>Assuming you already have a form in progress with your custom module (or perhaps you are modifying an existing form with hook_form_alter): $form[&#39;mytextarea&#39;] = array(<br />&nbsp; &#39;#type&#39; =&gt; &#39;textarea&#39;,<br />&nbsp; &#39;#title&#39; =&gt; &#39;Basic Textarea&#39;<br />&nbsp; &#39;#description&#39; =&gt; &#39;This is a basic plain textarea. Boo.&#39;,<br /> ); The above code will make a basic textarea appear in your form. With a couple of changes, we can easily add a WYSIWYG: $form[&#39;mytextarea&#39;] = array(<br />&nbsp; &#39;#type&#39; =&gt; &#39;text_format&#39;,<br />&nbsp; &#39;#title&#39; =&gt; &#39;WYSIWYG Textarea&#39;,<br />&nbsp; &#39;#base_type&#39; =&gt; &#39;textarea&#39;,<br />&nbsp; &#39;#description&#39; =&gt; &#39;Woohoo! I am a WYSIWYG now!&#39;,<br />&nbsp; &#39;#format&#39; =&gt; &#39;filtered_html&#39;,<br />); That&#39;s all it takes! Keep in mind roles will need access to different formats and editors before it will appear for them. For the #format declaration, you need to use the machine name of the input format- in my example it&#39;s filtered_html. Sweet! Now we have a WYSIWYG on our form, and the input format will allow for text formatting. But, what if we want to adjust the size of the WYSIWYG? CSS and Javascript not working? That&#39;s okay, we can set javascript directly from the FormAPI too with the #attached property. Let&#39;s say we want to adjust the height of the WYSIWYG area: $form[&#39;mytextarea&#39;] = array(<br />&nbsp; &#39;#type&#39; =&gt; &#39;text_format&#39;,<br />&nbsp; &#39;#title&#39; =&gt; &#39;WYSIWYG Textarea&#39;,<br />&nbsp; &#39;#base_type&#39; =&gt; &#39;textarea&#39;,<br />&nbsp; &#39;#description&#39; =&gt; &#39;Woohoo! I am a WYSIWYG now!&#39;,<br />&nbsp; &#39;#format&#39; =&gt; &#39;filtered_html&#39;,<br />&nbsp; &#39;#attached&#39; =&gt; array(<br />&nbsp; &nbsp; &nbsp; &#39;js&#39; =&gt; array(<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&#39;description = setInterval(function() {<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (jQuery(&quot;#cke_contents_edit-mytextarea-value&quot;).length == 1) {<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;jQuery(&quot;#cke_contents_edit-mytextarea-value&quot;).css(&quot;height&quot;, &quot;200px&quot;);<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; } },1);&#39; =&gt; array(&#39;type&#39; =&gt; &#39;inline&#39;, &#39;scope&#39; =&gt; &#39;footer&#39;, &#39;weight&#39; =&gt; 5)<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; )<br />&nbsp; &nbsp; &nbsp; &nbsp;)<br />); Note that the above javascript is specific to CKEditor and will need minor adjustments for other editors. You can also change other properties of the WYSIWYG with this method too. Badabing, now you have a WYSIWYG on your Drupal form!